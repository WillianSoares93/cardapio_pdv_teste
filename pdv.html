<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDV - Sâmia Pizzaria</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="https://raw.githubusercontent.com/WillianSoares93/cardapio_samia_PDV/refs/heads/main/logo.png" type="image/png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        body {
            font-family: 'Roboto', sans-serif;
            visibility: hidden;
            /* overflow: hidden; foi removido para permitir o scroll da página inteira */
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
        }
        #pdv-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            display: none;
        }
        .details-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out;
        }
        .order-card.expanded .details-container {
            max-height: 1500px;
        }
        .main-tab-btn {
            transition: all 0.2s ease-in-out;
        }
        .main-tab-btn.active {
            border-bottom-color: #ef4444; /* red-500 */
            color: #ef4444;
            background-color: #fef2f2; /* red-50 */
        }
        .mesa-item {
            transition: all 0.2s ease-in-out;
            aspect-ratio: 1 / 1;
        }
        .mesa-item:hover:not(.joining-mode) {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .mesa-status-livre { background-color: #dcfce7; border-color: #22c55e; color: #166534; }
        .mesa-status-ocupada { background-color: #fee2e2; border-color: #ef4444; color: #991b1b; }
        .mesa-status-juntada { background-color: #e0e7ff; border-color: #4f46e5; color: #3730a3; }
        .mesa-item.selected-for-join {
            outline: 4px solid #3b82f6;
            outline-offset: 2px;
            transform: scale(1.05);
        }
        .joining-mode .mesa-item.mesa-status-livre { cursor: pointer; }
        .joining-mode .mesa-item:not(.mesa-status-livre) { cursor: not-allowed; opacity: 0.5; }

        /* Estilos para Drag and Drop */
        .order-card.dragging {
            opacity: 0.5;
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .pdv-column-container.drag-over {
            background-color: rgba(0, 0, 0, 0.05);
            border: 2px dashed #9ca3af;
        }
        
        /* Animação para o sino de notificação */
        @keyframes ring-bell {
            0%, 100% { transform: rotate(0); }
            10%, 30%, 50%, 70%, 90% { transform: rotate(-15deg); }
            20%, 40%, 60%, 80% { transform: rotate(15deg); }
        }
        .notification-bell-ringing {
            animation: ring-bell 1.5s ease-in-out infinite;
        }
        /* Estilo para o ícone "Novo" */
        .new-order-tag {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: #ef4444; /* red-500 */
            color: white;
            font-size: 0.75rem; /* 12px */
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 9999px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }
        /* Estilos do Cronômetro */
        .timer-container {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .timer-green { background-color: #dcfce7; color: #166534; } /* green-100 / green-800 */
        .timer-yellow { background-color: #fef9c3; color: #854d0e; } /* yellow-100 / yellow-800 */
        .timer-red { background-color: #fee2e2; color: #991b1b; } /* red-100 / red-900 */

        /* --- ESTILOS PARA BARRA LATERAL AJUSTADOS --- */
        .main-container {
            display: grid;
            grid-template-columns: 0px 1fr; /* Barra lateral escondida por padrão */
            transition: grid-template-columns 0.3s ease-in-out;
        }
        .main-container.sidebar-open {
            grid-template-columns: 80px 1fr; /* Mostra a barra lateral */
        }
        .sidebar-nav {
            background-color: #2C3E50;
            overflow: hidden;
            /* A barra lateral agora rola com a página */
        }
        .sidebar-btn {
            color: #BDC3C7;
            transition: all 0.2s ease-in-out;
        }
        .sidebar-btn:hover {
            background-color: #34495E;
            color: white;
        }
        .sidebar-btn.active {
            background-color: #3b82f6;
            color: white;
        }
        /* Estilo para o modal de mesa reestruturado */
        #manage-table-modal .modal-content {
            max-width: 400px;
        }
        .mesa-order-details {
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="pdv-overlay"></div>

    <header class="bg-white shadow-md">
        <div class="max-w-full mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-gray-800">Painel de Pedidos - Sâmia Pizzaria</h1>
            <div class="flex items-center space-x-2">
                <a href="atendente.html" target="_blank" class="px-3 py-2 bg-purple-600 text-white text-xs font-bold rounded-md hover:bg-purple-700">Lançar Pedido</a>
                <button id="close-cash-register-btn" class="px-3 py-2 bg-green-600 text-white text-xs font-bold rounded-md hover:bg-green-700">Ver Caixa</button>
                <a href="gerenciar.html" target="_blank" class="px-3 py-2 bg-blue-600 text-white text-xs font-bold rounded-md hover:bg-blue-700">Gerenciar Cardápio</a>
                <button id="logout-btn" class="px-3 py-2 bg-red-600 text-white text-xs font-bold rounded-md hover:bg-red-700">Sair</button>
                <div id="connection-status" class="text-sm font-medium text-gray-500">
                    <i class="fas fa-circle text-red-500 mr-2"></i>Conectando...
                </div>
            </div>
        </div>
    </header>

    <div class="bg-gray-800 text-white">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center py-4">
                <div><h3 class="text-sm font-medium text-gray-400">PEDIDOS HOJE</h3><p id="stats-total-orders" class="text-2xl font-bold">0</p></div>
                <div><h3 class="text-sm font-medium text-gray-400">FATURAMENTO TOTAL</h3><p id="stats-total-revenue" class="text-2xl font-bold">R$ 0,00</p></div>
                <div><h3 class="text-sm font-medium text-gray-400">TICKET MÉDIO</h3><p id="stats-avg-ticket" class="text-2xl font-bold">R$ 0,00</p></div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- Sidebar Vertical Esquerda -->
        <aside class="sidebar-nav flex flex-col items-center py-4 space-y-4">
            <a href="pdv.html" class="sidebar-btn active w-full flex flex-col items-center p-3 text-xs" title="Painel de Pedidos">
                <i class="fas fa-receipt fa-2x"></i>
                <span>PEDIDOS</span>
            </a>
            <a href="venda-balcao.html" class="sidebar-btn w-full flex flex-col items-center p-3 text-xs" title="Venda Balcão">
                <i class="fas fa-cash-register fa-2x"></i>
                <span>BALCÃO</span>
            </a>
            <a href="editar-cardapio.html" class="sidebar-btn w-full flex flex-col items-center p-3 text-xs" title="Editar Cardápio">
                <i class="fas fa-edit fa-2x"></i>
                <span>EDITAR</span>
            </a>
            <a href="gerenciar.html" class="sidebar-btn w-full flex flex-col items-center p-3 text-xs" title="Gerenciar Itens">
                <i class="fas fa-tasks fa-2x"></i>
                <span>GERENCIAR</span>
            </a>
            <a href="relatorio.html" class="sidebar-btn w-full flex flex-col items-center p-3 text-xs" title="Relatórios">
                <i class="fas fa-chart-line fa-2x"></i>
                <span>RELATÓRIOS</span>
            </
